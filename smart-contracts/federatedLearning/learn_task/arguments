#!/usr/bin/env python3
#
# See: https://docs.soliditylang.org/en/v0.8.11/abi-spec.html

import os
import base64
import re
import sys
import time
from web3 import Web3
from sha3 import keccak_256
from eth_abi import encode_abi
from eth_abi.packed import encode_packed
from secrets import token_bytes
from coincurve import PublicKey
import multiprocessing as mp


def encode_bytes32(value: str) -> str:
    b = value[2:].encode("utf-8")
    # check if the string is too long
    if len(b) / 2 > 32.0:
        raise ValueError("The string is too long to be encoded as bytes32.")
        return None
    # pad the string with 0s
    b += b"\x00" * (32 - len(b))
    return b


def encode_uint(value: int) -> str:
    # if value cannot be represented as uint256, raise an error
    if value < 0 or value > 2**256 - 1:
        raise ValueError("The value cannot be represented as uint256.")
        return None
    return value.to_bytes(32, byteorder="big")


def generate_addresses(n_workers: int, model_length: int):
    """Generate valid ethereum addresses.
    model_length only used to know to which file save the addresses
    Args:
        n_workers (int): number of addresses to generate
        model_length (int): how much weights are in the model that is learned.
    Returns:
        int[]: the addresses are already converted to int
    """
    addresses = []
    for i in range(n_workers):
        private_key = keccak_256(token_bytes(32)).digest()
        public_key = PublicKey.from_valid_secret(private_key).format(compressed=False)[
            1:
        ]
        addr = keccak_256(public_key).digest()[-20:]
        addresses.append(int(addr.hex(), 16))
    # write addresses to file
    prefix = "/home/user/ml_on_blockchain/smart-contracts/federatedLearning/learn_task"
    with open(prefix + "/generated_args/addresses_{}_model_length.txt".format(model_length), "a") as f:
        for address in addresses:
            f.write(str(address) + "\n")
    return addresses


def worker(i: int, worker_address: int, model_length: int, results):
    model_weights = [42 + worker_address] * \
        model_length if i % 5 != 0 else [666 + worker_address] * model_length
    # model_hash = Web3.solidityKeccak(["uint256[]"], [model_weights]).hex()
    model_hash = Web3.keccak(encode_packed(
        ['uint256[]'], [model_weights])).hex()
    results[i] = model_hash
    # print("number of computed Hash: ", len(
    #     [elem for elem in results if elem is not None]))


def parallel_compute_add_new_encrypted_model_hash(n_workers: int, addresses: [int], model_length: int) -> None:
    """Generate an array of model hashes. Model hashed is obtained by
    adding worker address (as an int) to model weight.

    Args:
        n_workers (int): number of workers that we want to generate model hashes for
        addresses (int[]): array of worker addresses
        model_length (int): how much weights are in the model that is learned.

    Returns:
        None
    """
    start_time = time.time()
    # num_workers = multiprocessing.cpu_count()
    with mp.Manager() as manager:
        # create a shared list to store the results
        results = manager.list()
        results.extend([None] * n_workers)
        with mp.Pool() as p:
            p.starmap(worker, [(i, addresses[i], model_length, results)
                      for i in range(n_workers)])
        res = [elem for elem in results]
    prefix = "/home/user/ml_on_blockchain/smart-contracts/federatedLearning/learn_task"
    with open(prefix + "/generated_args/arg_addNewEncryptedModel_{}_model_length.txt".format(model_length), "a") as f:
        for elem in res:
            f.write(elem + "\n")

# 1 million weights -> 29 seconds


n_workers = 1  # Â currently limited to 100
# model_length = 1_600_000
# model_length = 2_000_000
# good_model = [42] * model_length
# bad_model = [666] * model_length
# # TODO use this line only for pre-computation, otw you can read from a file
# start = time.time()
# parallel_compute_add_new_encrypted_model_hash(
#     n_workers, generate_addresses(n_workers), model_length)
# print("Final Time: ", time.time() - start)

# generating arguments
for j in range(20):
    print("epoch {} over 20".format(j))
    for model_length in [100_000_000]:
        n_workers = 8
        print("generating args for model length: ",
              model_length, "using", n_workers, " workers")
        start = time.time()
        addresses = generate_addresses(n_workers, model_length)
        parallel_compute_add_new_encrypted_model_hash(
            n_workers, addresses, model_length)
        print("Time for model length: ", model_length,
              " is: ", time.time() - start)
prefix = "/home/user/ml_on_blockchain/smart-contracts/federatedLearning/learn_task"
with open(prefix + "/generated_args/arg_addNewEncryptedModel_{}_model_length.txt".format(100_000_000), "a") as f:
    f.write("Computation done... DONT FORGET TO DELETE ME")
exit(0)

add_new_encryption_model_args = []
addresses = []
# ugly solution is to hardcode the args and read from this list
if model_length == 100:
    add_new_encryption_model_args = ["0x3bd0a7c899f0c53ab15df22509471d8a12ff2ddcdfd9e672b6515023d550bf03", "0x2662e793df4f14d95427defdc06cff3be4052324729a0bccec386fd00b67e237", "0x33a9364924b5c20c30c934d9698275680444457072513d381ebe776adb9a7c5e", "0x07fe489cab05af698856182acdb4f85bf7e8344d342522e3e39dc06edb4724a3", "0xb42d3091136195e07dea3934ef031a7dadc8b7bcaa0975ff339be997bfc0d5d5", "0xd16852f39b80f4dedd3a5223cfb8f037ebac3e3e01d5bfb214b457106799284f", "0x0e2da61ed6125827ebbb60ad329ccb8398086bd0ecdd68e90775e1d627977fe6", "0x3d711284391a6416b5c373be8352e3c14705674489406fc81a6b219776c82aed", "0x0ee05e31a30217f6b53bb3c76c2b304ce982e6494dd8b261d8c6b8624904cdfb", "0x348811f14eb4f3af60a5ca85ad54d54f2fe880b40d5fc5951bd3c7da4b9e5bad", "0xbb396561c3997fb480112ab7814b02a4377a9084b73ad1d34080d64cf734f65f", "0x7b999157ff37bfa6ce1954a65b28f0bfb25159c6668e7e06ef781d65f0a4eeae", "0xa8a9681f4e0b3f53dcc3c0b0d18d1064f9ea0b35a8fa7a8fc9b1e5eee5ab917a", "0x5ab929eec247f6dca5649229dfd5d3c393420f557166835eecfac2faebc09277", "0xddd9cf9ff0c8011f392573fa40193f1a7663b6b70d480d6d9eb239b048598909", "0x7ad4a24818ef5976c5b47e10408c19a6fb53c456a4ff879e57a6f7c52346d8e1", "0x4c41bb93432c36ec868fb89419516b04a88baaac9ad31f6ebb282bfd283dbdaf", "0x78966bba1abca6528a278b7698a6c6e024a768e5a2b6b8bdf7365c30168fec13", "0x4af0ebdf4e02c19950fbd3c464eac752ba19180b76153615d2d026aa70322de9", "0xa95e53459686ae655d5fdc041b36128253bbdeb07540700ce5650499166bb9ed", "0xf5cc3383c8cffc5b88a1af573deb17afeab7b04c662218e106b325233a976224", "0x18c9248900162e8683a22d21f421da27a4878629d4d4ffa4bc758d6cdc62202d", "0x42cbd2f6958834190c405ad4cddb561ed092918d6763b29aaede3a1501abc44b", "0x55762d416d0a31a3c51386562285e7f8c9d49e4c8de221597379ec042eda837a", "0xf0c3a90c78ed201eac90876ed6f5495a59ea065bedf8c317ec73d1cfa31fb1ea", "0x27ba4beb6361ecc81386aa08d0669635faac633c1d938c23d3aff94a070142f5", "0x1a2ebbe40784661e01dbd1a6613e09dd804c3cbc67d7a9e15acd3fd6e2044160", "0x1a66db9f60aaa3972e3fc2fbd4556b7ff031b191aa67688cc5e953e1f69c4d84", "0xb1caff7a502830d71ed76131cd24e9101639fd70a34cdc25c4fb328f90cec8ae", "0x580eb9106cfc99d18dd9a9b6d4e8f4269212331583d32e0aaf6f482ab65c92a1", "0xc6b4f57dc7acd93a79cf057d6890048bc1864fcb41d7a43b31c1eef0f1d0a1d1", "0xc336146f50347a61a07feb49bcd25274fe11447d991394141c6f515fad86c9bf", "0xcadd81f60eea79cc0075a347347f212de83d8d9054e561f4801fd702c0e2cd43", "0x860635dea1ea9bfd12ff6dca5883a03744a9d502b8662f0b539582026a71e52a", "0x2709007d022c095215c63500c766c5a420eb6eab31b7911ac3c3b45086801e8c", "0x39ba49354ed682a5ed117ab90b8b063b8079abb3dfd4d4068fd727577a64ca8b", "0x80f38eb537881e79f3488fb2dc8c09377215da52f5f372ba1a4a4a11a96b1797", "0xbbfc5b4025d8260859d88d5a9ccbc89f2cc16b450d50f57dc6800a62a33d5c5a", "0x5f999538c3e515bd29589b4057338e81c4348e1a517f969e67e49ef100e5c902", "0x8b5df5977dfb6a431264a887d085015e6aa8cc09a08d1574f580eef7c6343ec7", "0x88a1d55f9e343896601eb659557aca60423163d82a596b08c0e7bc0dafba740a", "0xd8fca741365df36116d27479bf90df1193d8ee6b9d41180dabbcd56cb7754724", "0x1b49abe15d99261cec2c5fdcb0a8f1e7a7d5fe445b38168d9ee660d7492a7f1f", "0x878c5d918e14af901d074d1f333dcd1b7a2c54765edeec95dfb071d9a0a93c77", "0x4390abc82a213d05f6d87643e35cbf190b0c827b9906cbb8f9544ddfd010e138", "0x24bbfe59f39d11d90d7605a67f436601236072133cfc70cc9b16724785c3598d", "0x840e7f9a99c8ac101ee2cfac601bef96fb2a1579866c4808111caba6814638be", "0xb40a4a28d6a9da6b6920617a8dd7b66660f89d04d875fa3cf53bd2251a6587b7", "0x07bac298550db17fdc4c7de6e2f8f77391c7af9ccdbb7aa29b11767d4b4d1662", "0x442b3cc216b01a817baba1fc0bfc6b2b2e6245fc7c9b9e4b9f721afe20ab7468",
                                     "0x24d07e7fa59af69f9f17a4a063ce0b291c90a6f09618bfad0e43d11431d11a44", "0xfe7b970285f6a89dfacfeeba8ef7888486d03bb973b4ecd885d88cc83aa8c106", "0x6664cac96175c7425a181c526d1d5eaf838ec20191d55a011215b5072082c053", "0x398f098eba0fd57c14f0a759da96630715e6021f826d0b02fddaab269a7b52f7", "0x371c80e06edc6bc685003914631817eef801ca315b9e5dee247cc584cca53965", "0x615df63fdfca534f48752f2c49db58e8e71d0df236ea2c39657a765cfcad4a65", "0x74e96b896cd4f5503d027a6013292ac5c68cbb43bdf7367cd7c2cbb8d4905731", "0x2cc8c4fba5b9d45123748c96c42ea47ec6a3be663be2bb468efda2cbcc13e762", "0x1bd29a8ab0a2bb1e40692c4042fac8be9519744970ef70b281cdda8d4dc09b31", "0xa8b71cc3ebe8a1fec1ceafa7bdacc5b6564ff4d0258413f4030738553cf12387", "0x60e93b28b93be4516317ebb59a7a4ee875211226fca14a3c898ae5200fccc694", "0x13b0cb6effb30766a2b3749096ac22ec85631c1903bc9359314469e943bac854", "0x7f4c78222bee60b652205224e53a52cc51a7e9bd18517372dd501e23576c36ef", "0x959b832ee02d4895885c808207d19ebf1ba58020a2248dbfdb59f14e7867c6f2", "0xd38684af3b1642f92430df2ba5c2e311077af6436e6bd6e413148a805c86b78d", "0x962c30016f5989fab25b2753e773f13ef603cd01de83fd1aa716bcc7cb8ba15d", "0x56c691199109d406a6b1f9638f729735fb2e086a11bddcda7e5764c08bac5afa", "0x73d17b377eff0dd38a12f8bb5c97c77caabad55b8efce307e1e5fc455f5dff83", "0x8792fa8b6dd17604fe87fccd77d77288085faf27da77b051ea292bad34093f14", "0x589bdfe00dd1e61c4645d8735adc70b03ee9b4998b0308bb8c486dd84dfb1ec2", "0x441fd9a57521b855ee21ae6368db0901fff722f64bba1a0032a250393824b929", "0x51656245625d784add2d6a34977ed56593e370f9157d7f048234002d4a5dfbce", "0x7263fc9d89bde486c2bf1b924c14a33c15ad53f49d1f90cd80ecf5bb16059073", "0x6db6b55bef72e4ad8105df3901059b7cfbd010993a92a56bada70214ab63e8dc", "0x3cce012eb9073e7cf5e38780965581fbd4474a3164a8c1ba351d551fb06a7564", "0xbb1f393a3dc0dc54ae265ef0fbd825d0dac3be17130f284ef4a774e0e8be47c2", "0x7f4479a72ec2c1967135eb8e1409cb7762ffe8b48d0ebc4f178dbf99d5397489", "0xe971e1afc2ca1585fc983f33fd10bb68792d27c89d3b1bbeef5bfa8650105c00", "0x77ebdb899040601208a1a8a13023ca449a708175b2a2093ad1f954b79a7cfb97", "0xa5ebc97368ba7864b876a5bfb8a4645a78ab4f4f80a7d08f2549043ffac6f9a9", "0x90e86b520dcfb6f12d39ba1fb8235d9354c678474d929421f849f87762e542f9", "0x25211e02f08fdbfc2116ae664be1718350889915df80ef47b29473360391038c", "0x69abe388e1cc8f3b3a1c925e2d7df109aaaed3d5212f1f9b7e5061049ba383ce", "0x79ca27dfca47e44b4a18a474e86c7f05df6b1e649e1856fe450fa9b27cf99f5f", "0xff69f4ec4f599b0e14923e2069ebe018efc46a3b3fd131bfb8696e3110a7f6ce", "0x9069c46f93526ebaa799c62124353f9c1c2848a9343b7a0de7c43524a7e77138", "0xb6999d3a50a8eb7024fc99d40d610bf12ebe31d117a9fb4827f92b6a1df64c9b", "0xdbd540010f178f03726481b04d5f3aa5400571545c0bd682c704274b996a93e6", "0x1d782532beca274ac51c2a056a733801f88007b093b4a07e52dd4f4b02dbb789", "0x3e06a2a2291598be8953a8f1dc0aa29cfde47a23bc7a83fe8d3c660ea23d456c", "0x9b7b2216bcfe4a19ea63dae2fb4cb99494ce22a892727ad2f4fdb78a1d5e5500", "0x8d73ac603c836a8247c841a63d4ee6d0f34afe6db3e0ca9e2c31e5697304f4d3", "0x7359f10695f19f6e05e38c42e2fef2bed7601ec8fb7e7d240e59e57b5b738565", "0x7f4cebc3b2532a674e8438115de288d421e20e348dbb4f03e3fdfe4a66cd5362", "0x5cd0261b52affde48451cf371ea9ffba45c7a4df0116e80ccc4b18b42a832527", "0xc0e6daaabc0917cf6f6b370d69fd1f1e16066f7db43aa508e4927a58f3328505", "0xe3a27fe7e75a16ed6b57d22735998da50492154a1bee1d5a2efc86961bb750b7", "0x1dda54fb113bb827983f0929db726943b7ac25e44b6afe42fa4f547923a52a64", "0x5f4beba75625d53877c92c89cc15686a8cfcf629408b8936886f5bd4db63ef56", "0x4d8250cbbf999b2b9806828de6b716dd739dcacddd7acc6c02333c0048c7c098"]
elif model_length == 1000:
    add_new_encryption_model_args = ["0xd6fbf129216fffe69775bd726e137235e00a146a81f760d1a9b01c6f41426bb6", "0x2d04c1ca998efb0d80c68f893631b8463738ba7f774aeaad65dfdeca60935a29", "0xb5fa83a0a76a0ec5cbc07cf783f3cb002e4364d1ff5a2d0a14cfaa2c28a1ace6", "0x3dc74cdd7583d9e193b9e37ddfb7f12da62c990614e87b7c38b227faf2f03fad", "0xce0fb9250d1caed5dffd0ef217228c82819e61ce3afca4d27e5fe720fa52c7e5", "0xf31303e95b46bc71fa5e0f2ddd6d81cbc08a2cf1fadad325aa3699c0d73bb7ec", "0x81c03f38660adfc1acc8bc669e7e1cfc7e23647dafc143916143019807a03bee", "0xd49a7164df0d85d7871621a393d40d98c1809ab8390d90779474fd51efd2642c", "0x1eac1fc0e3508a48e7ea6b6bdb353e5a81fa223f32ec44473495af3863562b48", "0xe4ad1fececb9cfb895cbd315f21e37e1e3f4937583588a970c8f62d348993205", "0x37070e7b3c0b658cb9db5393d9e35e3ef7942e267189c8421a6077af96486cd2", "0xee8b70fea9ca8c2bfeb242cc2df8715d8e52f2f73696bdb220ec8f6c7ffe43e0", "0x389b6f7a41e7d894306b37b9ba8305afe124faafa16b6bd012763a7cc1f9cc29", "0x4ca5045bb43f45d9a2b8708d646b211de446b5379af2acc4c925be731042fc0d", "0xc4c4175da35c83029fb901053c08293ab9f589163d6945a2ebdc339b87a64261", "0xe8461ef8bda9278b630e6c81a0dc6e2846702f9a212c72e8ea4ee72bdfc688f9", "0x73ff7646a00f1b2810513e97be59b2024f1e578031e17301011af789418b3fc6", "0x9196865fd11e0d503a7974515e3bf43b048ee8177e848b00e41b866222e90f2c", "0x87e1363b2fd324286fa0c8b898e59ee55933fbf14440d9bf6d93454dfa94959e", "0x463ee69701e735fdcb232c9218a35091280637ad1dfa0e85a50491b520f8dbb2", "0x67197362df7b2c4c37e1f0f1c9a97a53465197de6af3d43d732e731a4068d07e", "0xde6383fcdd668d32a8ccbaaaafddec2daeba3596c346a580afe4bd25d52a660f", "0x9704b46f88a584f8059c02e430ebbcdda8d65e18a117e818f60b8dda451ebaff", "0xa5fd95ff38d55e9b0000b581a3105ff5a5856789f068fa62d2890eb5d9e8f164", "0xf7c38b6404297069fadc3a44ea3d6e678fcf4937b090718efd93971f2a4140ff", "0xaa960692a778587d8c2d085859908ecf5651b3df1e75ab3b4781fa4f5888c2ae", "0xdde3a4b6b0d9a9e5e3128922ec74a36cdf8f34224add35953df00f1525698333", "0xc09e89dd8b42cea140e0b9ea29f6722d209e3ff5c3e4246032546d9615f0e30d", "0x49305f072552e0c02e628773562d97280d34b01ca994d9a8863c2bdb0a7381cc", "0xdc9ef5aff96b2b2a5ff451a00dc5d50afa66efae62ffc811cb6d55e8633896e0", "0xfc45aa79563d9aedcfa7437a6e54dff46ae7982cff6e98d0ad16f38343dc526f", "0x082c20bbc8f6cce197218eb0ad3c9bc354daf8a0323d8c3be99ff25b78463f96", "0xd95d5420d64812d756c2ec05b785ca731123fa429b5a470be4c26ce60dd3a72c", "0x1b3dcc7807209507a93114c163207bfed0a215de09ed7d44547125cd19332e02", "0x29ce4c18005e1286f25e64c3245f8dae56a1cb3624c3276cf3ffe2ddb951cd16", "0x57e59e20e5e97984492a549c2b8c7c5e3a6ab161d6221e84648adaa4662c0741", "0xc976ad2a96e25f9f13401ab675dcf893ee6bcf813658cad606043ee5427ce0b9", "0x9764531880b18acfe927985796be2b3ffc2daae019399885b392a769b1f67d0f", "0x7fcf05696869cd7fdb3ca3db572d01a132d5ddb5c4821bc39413dda12ac99547", "0xab8233029db0d1cefce7d0602a0f05b352a175ffb8dba157c697acd52f396d5e", "0x45f8df9a82ef8e6d550251d067f84b10f62661d3b20728498a5cec6dd7ba4d66", "0x59d175b2e32e71601febfb5c6f026f4c178b8bfcd2bba479750929e5cb7665d6", "0x1222919faf3ae1ab9fd1ba54910e297281296783003cf9ed29f88b499fe05366", "0x0972ece4299cb56b74eaf30741c48e220e168575cb3e995fbc7da4fa308f842e", "0x38cd5b822d2d4690d7d9fd6c7f826169c8184583edcce5741e13abab602c2005", "0xa647f02fad33e79daef7758b2a95310105720ad803ec3b8eb57ab909e722e5ed", "0x05395393f12e52627548644397ac1c53d093e0f9eb9114ac4504772f61167294", "0x45c4ae1e4ee4525c11285017683670941e8784e035b2ce0120cf202b4cee654e", "0x5a2d5dcd3d327c3137acc85e408fc23e9cebef50abe6bba5024f40054d89f7da", "0x9b59e3327eb0f60651948a3bc3302dab2143e4a9b8608f390d4109d1421cd284",
                                     "0xd48df415cdc7f1f3a8dbacbcf7847dd7a3ec140f0ab94a2bae8d407912b3f491", "0x6dec784435cee838b20940f303854ee9188dfce083791b7c121cbd1f53411b50", "0x04887ee77d82d4a08e2684575db907f66b93cd38ab4aa9ef3e0865b675e9cb7c", "0x83f78663e20bb1aa22280c0222ee643ca674054dbfe9bc6a0e65309c73c17602", "0x7e6bddb4148da679ff64c44d3297ee47a7febb4b49db8c768c5a3f468d3dcf5d", "0xe85f3281404cb3eca4113d1bf4b077d885dbf8428baa2a86bf72bb603713ebe0", "0xd2ce5ed7fa55aed8fe434df724d18129bdbb45baaba629556543e37a97de0236", "0x5947e3a541ac6b923fc941d0c7c21158e4453f671f610de4f22699f3f2549208", "0x12e9901405cada368d5af2f9fe70e1eb71709f7b8784ae4d828621dd259659ad", "0xa0f8d89e5866a6d878defaed3dbf3a8a584d0944520cc0cbd206ced71a908370", "0xed0bcb2537d54ec993b9e862482d608d15ebad7780dc705dd49aeb73951d9a41", "0x2fd558b93a077444fe0df64896529f4858053a09599909f23342550f34ce1524", "0xdea958e3e23b840c34ca51904544fadbd6a7c5631ce23f2aeb6bb3f817fceb05", "0xcbffa037cd28d8b5d7e7a2137f8278004ced4e2144cb90c67b71acc4c215520d", "0xf1ad9e4ccda89423e098161f7dcee2f93021dcfbe5a839348b62944d18f363d6", "0xefabb5b5f6158961e950eb975d2eba60dc2bf2071f740d922fcfa992da62bb08", "0xa96a62096329de35a6073f97c7733fc0006ede001b88463a61dbe759f70f30ea", "0xe5d4caafc0a06f8846e713bcda6bf8aa2a088c8dabf5297a99bc0769922498c0", "0x6c07f5e730f4f269a707c8dea3e4a5ae0202d843f216d0919570502754d2a65c", "0xa1e8d433bef66a2e03aad03a539d774cff5de9e1cd2b9019b6e541e278c09218", "0x2187e18750ebff370cd385ff807d16506895ad7f446801f9dee7486fc2f5bf38", "0x2c6dfab9374112d8a845c41ad9138bf144b80553a9367bf7355c5e3549ae4353", "0x3894ffe01f1958f1c80e149942cb323fd4f1fb4a35911237f8a9a68eed0a26f6", "0x139a5ed4816d21b3ee347a71a2925d66a957edba69c0ed343bca2f07d1bee994", "0x33377de69c82dbc8f4a9407e2699fd3016d54a9b672b920269ad274efa95ae2b", "0xa083571a8b0bc42a65c6bd30e7091d4a91beeb99d6a5330585b8e665e917c609", "0x1da39b719ad1db215fffbe3d812f54604ee2b5e1e839568fd5d1dee90626ebec", "0x63face964aaad573bb0662b8747ce94cc106ca6f9d45cd593f17aaf2a865149b", "0x9c7a6d0192226b437091b64e2a8d5faf91335dc0bb67fb520470f80977eb9fe5", "0xc14dcea94dc3c96986d93a8e8c11ffca0c5414dbdd7bf39edc9c066d42925e05", "0x3c7a1c77110148cdb8ac98677c3ae36e82b348343bc690129a3d91c8fe77fded", "0xd6e7bda74b40107623ddc3f26c97b24f10cee445208843d3eefc00fc8ebc606f", "0x683111a70487c9c0e954a298b5031a2db7e37608673447c6ba12b2aaa5e54624", "0xb42efaa66a3b34f1cc1f954667efd4b8e6ef558cfb2c9f0172548e18b5c74f9d", "0x4ed2244232a48e6f9b4f55038c0be25c7758112109ce41f92f3e05262f6a0b48", "0xd2b53e85a4f8b5d34b2af306444c3527f83f7800ca0760c7e709b9d8dd17dfb1", "0xc82c3b213fd62336a61202eda12ed936c3022df69ae0dee47ae27f1c3db01321", "0x81e78699e36afc4fb6530889bc680c4997ab9d131cc5ca210ff9715e2a368163", "0xe5ed8ad9da8468639cc98a11a27efbf9198140e91267d2384d217e62e415bf78", "0x7845298b7c0cd1cfa76c92604ab4a7c7545a1062839ffa1ca1a1d7d3928fa41c", "0x7230c9a751367ea9308295a8005778500fbaa4f3fcec2f6d9d01d4a27767d0a0", "0x458f27f93ecded172dba2882320f24a8c5133f257a5c9dbc77c5c7724989170b", "0xa67979e2f30e8991f246cc894459490aee47f7fd47261ff548fabf78176b66ae", "0xf9ab206a539f70e116418777670a651b25d64c542a1925a215ac58bb09161364", "0x78f2ceaee1eb5c5a22f495e724a5c7be389a3c178b46b88fbb2c7854defd1d4e", "0x155feac80b80f8aed97066dea4e20191e1306c7e9ae4055b995109fea4f6df7c", "0xfd50f31a4fb302e59eb6246dc6345d9c833220c0c566e01548c850c6e1f50989", "0x9097cf1ce0962c96245f5aadc57ac7792eba69143af32d493d8744ceab1c42d5", "0x00e42b95b6791b2c4e38c65685b6b0c48a1b5d22a11b5a6d39ff8a1e675f8f62", "0xffec58c284b83d65c5eaaa93f0478b25726ae93c68cfd0522af68e3e293e4b93"]
elif model_length == 10000:
    add_new_encryption_model_args = ["0x8a932b9e8f220bf873add7aeb141122798be0e410d922acb770266a848da9ebe", "0x142ff647bde867341c07861fae32e03c7c7f3bcb723cb8dca55e263f6c4acad5", "0xd4b8e0b2d878dd3ff014bb561f43e70f623bc94c634b299484ecfbb0125af968", "0x7261963008a60517eee3a08e4c4c7fbf4c79e3cf013ff41f2ce835b0a3973a80", "0xdb661fc856459ed17490d46ad5f83cb4d01e27c6f47570a887965e010d234625", "0xd9387237d4e3a3f3021ab0fa6d596fdf5235f8327b52ccc225595aa932a0d2a7", "0x3c280d893be3c3c937be9d51fe3849ea603e2c1a2408ce0f070a953a94da2ce1", "0x18a9a9f72d2e10bda6b8b1cdd7e13c808499a3a795994a737cc495961a05828d", "0xe05ea9f4c346b57c352c1c1f68a32a915c06566c54c09a5d3035614f0ba5782f", "0x77e4ad9d8333d49dd4cf74b20b7f77eb39bfc44789b4554e0657e4a2ef216a2a", "0xc674df6c8fed46945f001cdad37dacaec4c52a939146e2efa09279c4dbe40a40", "0x38ecdd9fa9c5058c853736b8d603aa1da67b1d6a2278f9988a468af81b965246", "0xa834526974da1fd72107cccd420acdba52bc4818b691c531d3ab31ecabf3608f", "0xb282cc5180766a705461373dbcd59bba55f034967d1475990f9e454665032f7a", "0xc6abce8dfe9f411b922cecc70dc988296113cb7f79a77eb133d45767567b1445", "0x906a9115830341c7f91405109a4a307decbc71b4a0e0d89668f9f0308837bad9", "0xc015b7ffadb5c366cf031d0644a1d119b46603498e811065a5fa35ecad46d1bb", "0x965a982716e75ff3411e6d0872b261877085ead82bae3a589e1b436f3f6b4bf8", "0x338d53607c2c3311b99d6530bc0dc0c4228bd502693b2c22b0db4802054fbf22", "0x8e18f2714cfe481aae5c397b62abb0aa7329045d0c30bb6f51a8513a1446f057", "0xd087f14e60c5dbe0fd35e9788d7ec98afaed4a8f887371bc39ebd102cc3a9bf6", "0x358a847a8e00ff75aadd15f059bf0f64885bf3c2b5c71d11d52d596d707e3758", "0xec4a8c562b7b7aa4731d1b2d630956fce04973947201e36d5a9e1fce80637455", "0xea3ea26f6833ba935ae45a50a2a2759f9b107f7caa02b3aaa6bda1f843878de3", "0x3f430828b0ab6403cac6985627de8e88821cf342d75c498205b2a37a6982cfa2", "0x058df27fef2367cb4da104849f781b55985ed14361d0ce0529bd4301a3ef38b4", "0x59ff5a714e6603b9ce511c1adea39fd59903622bfd1b1b02358f7312894ba1d5", "0xf6fefe52cb7ed647563c5278567d46eeb9e02d3844dfd2d98cf68a927e00c526", "0x6178b940209a866730228ae59511b05a3426a2a302849e6d61afb6248291d87e", "0xbc127455dfb61a8c51c596065d26d699253b23ae8b9b44d922fc0c39735a55b4", "0x9aeedec6adf10435b15e284883a03ead29d478b16d1e527098b7b8a226f3ab17", "0xbc4b83fdea9aff531435c37df9ae3577d54d4264faec5a15378192d0e712b82b", "0xa4c1c8205e997c9ee7c981d476d2296cb59ab960fccc5ba01a476fd5dc5b1834", "0x701ea83795d329dfc70cf4b7a71e541fd27284e7688416d94f399ffa0cde64b5", "0xcedbe2d9687d7df70d41b50f43f7007b56f4e055d0a234ca20946d50d8ebbc79", "0xd4c6b4a0478fed5873eae2ad8d14336b1e0cb6861d6c10d1fc76c702e369886e", "0x07e6f1fbc9b6e5d515cb8e4b98cff2feba0e540ab34030596fd7123be01b6163", "0x90e76f5a013f52be91be545133738b37e009013165e02abf37ccf6b1639b4682", "0x16000bcce1791b16ed013cfacd68f99c4a62ef8bda48e641aab02634ee7a73ea", "0x62931924f06c6b475cb50c8c394e656791e2eba487f655680d85188880e47462", "0xc43d8f2c0a5270778396b331bbe1b43ef8cf4b57bddc537f137172643eb53ce4", "0x063727e866592e38d8d4f70650688c093df94098d44fb4757abe39d5c8824600", "0x3bbafff91576b6cd49e54bf8dfde483bcd2ade827419f2efe47058ccc7145eea", "0x0b87bd288112b211658858056339049546a6ed77a3293b3a599991239a4eeb2b", "0xb02f628f790613a3e56110789687db7541f796d242d3979469167e629b19e21a", "0xab8476602dd7c09212d97e772bd8536a439716ba1459eeb208a1c7ef5758e405", "0xe3c7ec73358249eadf37e0d55cca38fb94e5956893f3421fa0885b719098a5fe", "0x8f80ffcc6072f35fd3f0f6955108038a23c8f3e37953963a8c57dc9aa015c3e2", "0xafdb79f6b3e7697cd99f6d289ceba280fe4d89742751399eeb6e0d16bbbca544", "0xd129f5ad0515e0f325ab1dfae255e66062736af70991f7a360d465695fe88a90",
                                     "0x7ca1b5046cd3717dec52174c0a2fc0dcead11cc58316988f512916ae7ce29336", "0x2cc0fc1664bf903c5704d135cfbdb5886787a8d42809d891822165a72cec5db4", "0xf3ef4fcdd0d0c34a08713e0a0b5bbda77f783bba31a92821bed4506f33afc47c", "0xe800ea10fa4e5845f61693381cd9fc1209c05b248ed64660b4b0c64f27b60c72", "0x3cd2e6cbe07699aa9c7198a4684a9d9369236b8e75cd74ebe3fe2e3b2f0f9aa1", "0xc351338399bf352652d8ceca0606cd072c7d557677e838ed570512eb45dd50be", "0xc0251962a3a61b6da862fdc4d7ad6f0bf291a8db3287fb45d70d0234603e73c1", "0x29b8a200c981ad911f81fd5917c04fc283ffd8e09bd4c2860bc1c16334a306d5", "0x1183d5cedb6d91557b15e73acc72123edcca7a03e75d0b6e4d89596493202094", "0x08cc07522d10ff3026421074c80c89a3787164039971ed82c0458fdc84730358", "0xd1076e5b7bcdb2d857db6f51ec3da49f33d6987a9a03b6d68b37161ed78649e0", "0xe0018f7ca65cf2373078f27dac71e8b0657663b9cc0ac9a3409ab23ed5f8f1f8", "0xa90ed42adf3856a165f7ac68491a9264b6d5b6842bab3f4525b63b17d051084a", "0x3700964136b4bc687dcc4e9448375db47880a1da7dcbeb625f653d6a1c38be95", "0xdc2707a1fcca1fc5e891d9bfaff5dcae985c475cf9d3cd0c7a1f0b712de677b3", "0x41425dea18b1105226541c8b1d6fc647ebffd96618ea0f0c5645535036c172f0", "0xea9dde2026366ab06119d9547fbfce6b137da4a828e5751e362e5df097ceaa44", "0xff355e29e698b47a15933e18b9287f8c3534740f92e00c14d6be763ea4b4fafd", "0x3087175f990061a2bd2decd491042ab83b0b3e6dc3ea3cc60689d368eadbf77c", "0xc345763ce36ede4203d40bdf51fd71514e0e2cd8d4ef04b5c98870d3e2b6bfe0", "0x2337bbfde462bb8bbddf3bfcad0d59dce72adf490dcdc17a30654d0267044675", "0xe34e6e07390fd0d373a48362882920d75093f2ea95b3ca396311a86be030c263", "0x752cbcc4c77e2ea73ef4b955c762af30ec481c9a11e8ad1d1085ae8b392fe693", "0x6a4b234ead85d5825eb720800ccb6d331b2636767ef1cc0ef299d97c3302b533", "0xe61ee6384684c1d985404812eccfcac710aafdadb0f578828fa2cbb4f12e2877", "0x9c7c266677ea9017a194a406abb7c774f0f0a3bbc409523f0e9a9485e81b95ab", "0x441ee8a3407501fb738e732eb15d563099c20f0028f59552663daff20ae7dbbc", "0x45dd1599ae24e45dc0aaeab60394bd9bee136bce9622d07a98bd9a1b3ebb3bec", "0x166615bd3574f66189480ef8f8048b368d5eee5c6cf481de89386b4262b526e8", "0x402ff3360cedfde804d40bfb6f50e9ce046399d446c26593a3fc9b2b390a7dc0", "0x87c2698150d30ecf9cc462681935f48530a30daf8a2a8b1b0e5a09fb4815591f", "0xda7374fcd1c05482b3877949d4e3a423b40d9b9fc007b780dc29f719ec03bf32", "0x823087eba747441fd3852fce2577b32cf94c9197ef306c50eba35edccc6368d7", "0x4ed15283a3f3fbaa5e46027c55f5077e318d82ea3b1e6aab7d966fae925fdb78", "0x492d10981afc3580cd7928e531a1a87cfa1d099acf1c7928117ec1ea8c072f23", "0x348a9a87036d1819f1009dd95bbaaf19e80ba6fc1e5e674bd8f33351ce46f1c1", "0xa9d1b428daea32bbfd7660d7f0dfd1e396e0f331fcf45009e8a817ef419162fe", "0xd9acec18c6297f863ea9c9d556b18b826bea7ea375d826012d0c3db270900a62", "0xd1417c87bbbb6d6421019807e2a0f5c6653154fc2306d4371e5e3e0f890ad8c0", "0x65504717454da49fd48964e419e11c1775e397dc40e774a2e98a09c5b93ef9f8", "0x5fc440fd7338a4f37977ef54db259f37df97b9dd2be5d49390f62a1037663c02", "0x1ff843287ad43a29dbcaacf726b54588847a454b62120fc610a927171f2fac33", "0x17eada5d180cc35f1f7aa5dbde9210ed795c9edef7223db3046c483f7123cf2d", "0x3147030958cd53b442fbb8b248de0d056a8817e6d21802e490949786fb8367f1", "0xcfef44883fe710d3a8a5b8f835df6392e3cff808ceb647dbee27c5afe89d24d9", "0xa3678a440936f2ea54576d9a1fe99a9d35a759eb19d245752290345080c4f857", "0xb5cf505e9869e4990631e37f0664f7b84959e074ac2a846fa9324e9d71497b1a", "0xd9333203706fc0c36962ed1990b1123e5b07d72960e04d325a22a7ecc855bafa", "0x1ce08299bde05e034e3551a8b5a351331160092431e34761bcd2e156eda3cf0a", "0xb03c79a44d57bb061858ca919ace30285c51d1ed021e89d0a6d9dab78b393b05"]
elif model_length == 100_000:
    add_new_encryption_model_args = ["0x18b12f584ecb2cfed8928fde11889d89fcab21a5e63d7488e1718ec78d3eab80", "0x0ab142359298abfa7623178fa80bf29c5b59c6efa47f176d5b0b602da99cf2d8", "0xfb3a515817d1fbee67d21c98003202bebb57dde190c5df6e2f57b2362467f425", "0x30f97a02de0f947eccc2921c8dfd0393feb997b1797a78c829f2f81d8659ce19", "0x38878d160eeabdc7c7fdec9545e6f220a46933740c0cc0b9eb6d4084328e6326", "0x59579c526105e57cc5447174be797487acd0c8d7a61efe803fecf5abd4228af9", "0xb63cd080ba79f612bf1a1466b5d92f7fa1c2c766d3d0c451b482185fbb1fed6a", "0xc95b12d0589140468c755c9576ec78c107633a1df5dcbe6350b01dc8e433fee1", "0x8ca8744ab1e8fb7534b649f172f8b4b2725b71b6dc879a88f171ed61038184b4", "0xef600a04e9b3906eb2c9bd62b469ed4652932698d6cd1fba7d73ca4593dc55c9", "0x79e4b5d0929819db02e69ae772d469df8c6368bb3a1785eea96cc312f40c3b75", "0x03250d4af263d4ef36fb858c321e76f46006f73123ee4ef8bb4480d9f6297c85", "0x14d8bd63558e12727e76498ff2b9465bdf82bef9752e8eeffb9596c89d7578ab", "0xcfc8a2141a305962ff8fae115f0fbd2d0f4d91e3c24bd70eedc614c1afe53f58", "0xee81c6ca20890ec8227d37e87867d35d846965af16aae920d1f055252fb348f9", "0x02d7011fc1109e8486374d56014117a6c9ad6591a04041d32d05b649b6c1771e", "0x0b0fafc8b9ec21e3525293572c9bd7d48429fdff4a870bf4b0b5126d6bcd1a7b", "0x6e1736c046c3319bcd3595f94e4edb8e61cbd507cc04c277439be756dfdd5e8e", "0xfdcd627c803d0118142789b6129e32d9090753b51d70a9713094edcf9d4f6022", "0x50ffbb93316ee3a8292e054cec9b773f8eed8fe522b7be9b236f68868f52ee20", "0xafab4d1ba0e82825a107a4c8838aaffcf3580ddac7334a677eea09188ca746ba", "0xa5d8773647929bd84f3900f2a274ca82647a0ba987e91a19b0258204b750a311", "0x5bc90e2a41fba710fc1d79016df3a0ac4a2e77f5f57c3ce16eeac62a620729c1", "0x70f0d7d100d289bc88664d53b9436948c2e684aa4a1faadcec76394af49e060f", "0xf941669e26595febb9a08746e73d305980fb4ea55e2e7318e187458cabd75d0b", "0x292d638efb185d7eaef0948d27290cba5c90bb133b752839cb05161480517df9", "0x6c2ff08f98b8224b3ff43780306b88e1b39448a1f31b91b7f57292c7aa39b04d", "0x21344519418dd948b0e59e153570e234fc726d00b8e1463a80fafb6742bd6894", "0x6b9258f3ecd2cb403253bea8d27fb60cdaa52904b5849f78c575402f27a5933e", "0x33436d9b9e8746e532024db41efa444de68c009552d6425fed6d64b408af77cc", "0x70c668a48f6fd1b914a0eedf22aa7390f5f9c0ca6293f2f090446333dfb74113", "0x601f598b0601b14ad4e4dd65461d30b147de9322643706f24a296fbbcbf033c4", "0xdbbc55d3838fe42d9b46c59008a2e0048e048f9b186974c0c97d35541f5bf5f4", "0xb02561bdac3904776b1cf248b9032ec930538c5f39209546316e0203e1bf61b0", "0xac61acafe9272ec5e7b0456350353e1a9ef1dd099e23498913fb299465a5b408", "0x0989f1bea2fcf3271a2c6065c891949009840efdc72d3c4de263393f3744691e", "0xeed8ab8cc2accd40a88dfc0544f4f746b6ffa3f5e33e71de6c5af3183ce8049e", "0x0cfc5057e53a5137e699491fd17a44cfeb5a67b068b9ea524352845f74f28b36", "0x40ec18ca0d4c360491f5f84ec9ba7b4ebbfff513a1708a13ab6680abdf35b2a2", "0xbbd48dbbc33dc6ee869ef43ed4f067f9a82d57bc29167621d417b8e287a71215", "0x968ff17240464d75c69f78c6b7fceb2fc14245a8911dc76837fe20baac7ec721", "0x6912d2e37b9ac3abf55040ad4604ea747081f2e0b0d0699dade1050c72a71a8c", "0xe387a34883f961f6baab9109533b8474555fc391e5d3f07d37e4670f29fd765f", "0x72e9e5e0ae76f20cc18b2747a4d427440efea33494cbbb37ad0b02b0074df1ab", "0x5dcbc5b779764b050e3dd7504a429ba59fc801952ece79c1c87dc4e0d8c929f4", "0x62250309038bd69aecf0e76165245dd11e099b0ba8b41f0168f1c9f3dfad1b66", "0xbc1f595e935eceb2a5b2e197d5dd6c316fef04428d05984a3b6158b08fc4ccba", "0xf0c2904ac9da0bbd50217da5a0fb2eb71a77eb0eecf1890f03b8d82f8c1dc14b", "0xf3302f3a42650ce973784e961427d38a7dedbecb89a879ebe04037ac6309430a", "0x8aecf631d973f9e02d42cc86c69cef8939953195055dca0ce05118c1060d6088",
                                     "0x948b73cf7b6ccc02265fd8607818a801126a87faac2d89cba682984d201c5e38", "0x3c3ced3f71e0cccbd8a0efc589cabb9239580f5dd76eb62efd8f9fa375853f2c", "0x67cfd13bc420711ae319debe796fb66f7132a9876765a9bdf80b64e8c5f977d0", "0x880521bf9b66fe23f8c90d6ba2673c45994eca1889983edd6fe4b096b2307c1b", "0xd865006b4a2c6e44dcd9e9adc78fff4aeedccd5f69d4019670efbc772991b442", "0x215acaa060e7a36565ccad9d28863eb146c70e42b0e931a7988ff25786f677c6", "0x005ae34b6b574e5b613c166cb5870536b967d13a302909cad2e9cadcddbd228b", "0x9a497bd3f2da36b83a49e60103da59c34fde04ba7f9aee6711625f3ac125a099", "0xaa24c22825daa6d9ca3b47ecc2ee5b4f770ea71f18f85112e7868989d42f382d", "0xd7668f785378521c433e8e9e978508380bf5019330a869418b9b436565ef3557", "0x6c9408ba81a1cd3bdcbb1ea9ff257061c890a0b7243fc7a3f818f523b925e689", "0x10e05f8ef40f25c2fe0de35878aa744690c9fead5bca8112cfc9b5b7289b2dd5", "0xcc037508116584b934f28f155ebe55fd0967b1b7a907b74a16cdde14134c56b3", "0x18a740a15b11862f70668704feb9a91ff5fd36ae6b74e683417b2a830f94dd10", "0xb8dcb0a4968dcdf94f69e84bd1c91cf101b78d3e2bde22669be23ac5b4f3a77d", "0xa7edf4afb3d5fb4654b3f44341e31fc8c008e11cb6e46ba69e90e481c45b24ec", "0xf850e3374e5b717a3af507fff26d529ff95dd3a40be1d727184b260c646a0305", "0x7e46672568bb19c5844f08c985ec6921f1a1e1e397588f678a0beb584c4e83a1", "0x529ae46ebb643cba287db534a68d358013aa842b82297f033167b53bd386229a", "0x91c5b58b649e283bfc2642140df55cb5d313d22884716d94874ec7eb5849acc3", "0x2ec793d67d11a52026f53d154bd61ffb0a02b0301d177f1c18c1c3a34f3d25ae", "0xbb6106ecee53fdd919233068fd9607d32663411f82e0730d137d061914f8b926", "0x591a0559cbebd80029d9d4972b6c3c8a18bb7a5d54e21113f4417bcef086c97c", "0x668495e3a98f803ad58cc7c230bd7edfe4b1077f67968f0da83fa07a7ccc80e1", "0x0bc23504abdec5fae00626ecb120ae34a4db39bbd73977d4ca908db0d8b32fe9", "0x2bcd023c1b51a5f9e1dffc1eba15d44dc26b66431a64641eabc23a25df869d17", "0xe194b5b9e9cca11575adb10dcd1757647e66cc74307a1fdc1db57e57d7e46680", "0x8378fcb028e995a8876bcc35b3fe9946cdd62da101860e0e8ff4a8348c0d395f", "0x36e10e06d64a704a66cef6a8a1b8ee84c1c6c9b9efc20bb3f96cc14fb81c5f74", "0xeaee85f199da62fa59f12a2efffea1a3c3a2bf941d33e629cd595f10ba6315c8", "0x078eea4d9f4c3eabb3dce4ea063a44ad1fdc3e917641fb3ba79befeed52e7458", "0xe04f327d42d65dbb71427ad1322dfe1832a411ec5ac2445d1cec590ad04fce91", "0xab4bc4f195c2e4534cbcd3eba542197e377c9ce05a00132714578140a8988586", "0x874e286f6e82217879e679537de0d31b106726dfc7b4807f0d55a2a3a123856e", "0xeaf46342128b7c2ae4b3b872b31b5b2941f769a3f8253d74bed3d7811faee5f8", "0xbf7ca18ec4f6ef669fc0cc37a809c71e53a7b6fdc6d3bab7a817c0d8ff5dbfba", "0x714fc793591ea0aa1c2140a5d13c26cab2bc1bf5324e6bbdbaa85fc336b4f331", "0x8e90feb093321f9a7c7451b58d77fcb72199d5a96610b6fd2e32fc2397b5f4e4", "0xe5fff4122ee1a78921049c52301906189fdb8b6ce2589245fa237d4d970e47cd", "0x60db9869b8c5736203a027018694cf71b7dd936864505f0c47e080d7ee3ef352", "0xa22a7548cf2b00254b2271cc501a2ad1b8726495c0bce7cc2ca90faf6656c68e", "0x9a252f3e936fdd965720c2c3f05f4cbc38b59cfd406b07f08d52992e6cb23013", "0x2613d3a60e0193f90ad3eec27d6bf9b5aa996dcf0676582d0631b2e94c0fea61", "0x72d9a53e72ef27b36360d574f69f0e90af0b26527b01457e11e7419be4aa4ab4", "0x7b5590c667192b9ee3458ebac43c1de4f8c9cdf78cc4e15ea0b12123e6c23e36", "0x9ddd7e8db0c7e945b0cb4aeb9858dc63c94db2b890a84d779da445325e925b13", "0x8f154d006c7f98875a0354da250d7452b2ef263c3127ff4c11d8ee585756ff09", "0x15d8c6af2d56be8775eca38ce75b725fb29c6ccecaaad7b904518a344ba915a6", "0xf643dc0199561fafaebe879babece7700bfc438fe294a4aeadbd2d1669a87fbd", "0xa0bebe0bcfff60dafcfe72d55c35b9a4ef402b7a929270fbcacba08c37f9d20e"]
elif model_length == 1_600_000:
    add_new_encryption_model_args = ["0xa718ef87a60e01a3e8cf8f4610afc2f799c698d762bf26f50fbeb983543b6a80", "0xbb7ca7c46d5b9fe40f647369dc67e9a16a4dd8c7e2724a7b8db043904fc00a21", "0xf8b09a27fde67b946ecfa4d8810e7aabb2ad62ef910e69a8b8910af8bf055c25", "0x51c9d6ae5f9ffebf7d4bb51b1313a3ef5ec63ee8335ea742de0093267459c6ce", "0xcef9fec1725938981c5e41b5e8771111c3034656d35ee0bf7fd0dcbd67456617", "0xe344121d5d0f9fa875b72739b962c0183c63f7197301713dc67b2c38a5980b61", "0x084583bbfcea64692d58c8c8114fa8393878502d3a0734c71aac38360fc4f7dd", "0x8e07750320cab1f4fa0ab14b78d76fea82fc9495fd356bddea9a12fa4132d6c2", "0xf55ec14a0f6d1f0b63021ff8e0a1f602135b5f163cbfcdc3939bb82da0fea204", "0x081b7aa6d4c1e763f86ad2a33ebb3f8ea22758cfb38b4d40597e100c531fd204", "0x8233d06ca35fa0b89be221fb0afe2d51cb24dfd7c8703043f363f5a9892fd77f", "0x3bb763d37e355c9de46515569af55507e83dd864a22f623c6e437410e75606ce", "0xff1d5587a27afcdb5398221d2f7b00e033b8e3219e3d4358cfe99f28f46f8f57", "0x6f2979376337825288f46d27b0a832ccbcbfc2cb005eeed29b4ee7ddb7f22e7d", "0xbff19f883d226af17b1c4d3e145c8f2f0960f5900807344533d97d9596f95f55", "0x5111eecaa20001ee4f4f8f80c4d3c682229517b6ed6a5b2eed09e00bc2003f6d", "0x4efd2dbd3b762b6ef06e18f8b39c888085c8e2952cfbcb071a1454af02490dfc", "0x9dd47aef8494beaa33eea5314ae53d14f23c421c916b4059bbe543c40dc77696", "0xa5901680b09e7c2faf986584149db9bbe1b5af3fbf162248ea04479a67252d60", "0xbb88db3769100e6d06de6e4437eee488c18b9babcbfa47ac7d5af742d389b1fd", "0x2354c75cb2c2cf9daa299dd71c6d2e74074e7f11f00219329e71db8768704f53", "0x6888f5f0b52561e6cc6a1d9751a67de9b3fd0c6e395d8def5080ac73c1db1926", "0x8d289cf9f982f2aef83d87f832731139e5c825a24a99f875bdada0e2d605b5fb", "0xfd2f3b7efa5fb583b8c26e381368502187659f22408840a583c6946121c686fd", "0x439f464e595a3bb11ddf685cc88f2bfb8985465758f032d3a24ceeb2bdf361f4", "0x15f01dca2b05ab2cce9127f38586b0b6a943e13fb0400a0173e2def873d158c7", "0x126abb0863adde27759493503afab66865eed04cd9ac3ba9c337222e088ccd99", "0x7a7a786a54eacd415adaf0ffbe77b62cd27070d44590aa9d4fc77d8216bde592", "0x558b786c186078163f7404fe1bf19d957034a5ed8b963140fbb77698d8cb7df3", "0x0e20c4a12fce029b7df2cb31148af25194c6aae5f5fea933c5fe444415ab2c52", "0x29f6ef3ba0b39d00867ddf6fbd484a5a4fc2c69c0c716e0934f59fe7c0936204", "0xa71de2a7746fe6197a53042b9459c0df63d3514567157433431aa94ec8bc0b55", "0x77f6b3aa07e8f36b3ebce959444f8dd9a0702db9f76fe3ce6b64ceb3978707e1", "0xd98a9a092105ddd7e7dc55bb2d84483bfef4deb733bf7013f25185a5309b4794", "0xba21f87389421467c363f8fd7ad3830ec82f87d4e4adbe42eb140a3be20277ee", "0xb05ac7e81ecffb39d5d0706634ca34d9f565b4fa7df32c95bd4e4eca3c915d4f", "0x225a7b048b64d6ee7b92f68974f6090e30aaa37e77ab3887d2c8d6b1ca383a80", "0x4a416421cc7d4b298954328b36ab8b292800db016b9662ab36497ddefae954d3", "0xe1e73ac674c0a70117ce14cab9f30a7d578ad21d954823222d553a1686cd58b6", "0x96f68ed35d4ed0fe03d75ea0e29992f4bbdf26ec3b5ec50a9e970d1baa0544c6", "0x8e8d57d29764657fb6d4a92dd6d3ae29d37d65964698f9ad14f519fa78725d17", "0x23d79650e069d692dff2336ad7919c97ca4fab412318fecb882fa3095da2a555", "0x1cd5db009b0384f8ec941a29ce0a7369d24e487000e331adf2c558861db1c7a8", "0xb0ad185070a0b7bccee3ee2c98a33388f271b4988b9188c0e02a287cd4cd05b6", "0xc05a798017642125d29e11d9f413af942e23d967b916ab3e92d93e5ba84690b2", "0xf416df56095f811a7ff5760242ec8ee9ec677f83047f36ecfe3721cb0e88b264", "0x3535f993648c17799ed79353d4ddd2d1e9ef9d654f40bc6ea4d955eb5fae7a4b", "0x1d1d87f697c0c9d2ce0f4eab04e2ff637918f8f9011210bcc2492971f98dd19a", "0x37de1c5dbc697570d9d5980901fe8b21a0b2f8e84d82e1dd930a40a69023c0ef", "0xc4d2421ab7d6525181299b75250ad0bed6f17e22c7ef7c8270e8fadc64cda2a5",
                                     "0x1c5ca107921be9fe5363d05b5190a68ba473a5609146693a07e2b360bf882ae0", "0xac76005c44f76c3f472d7f3c564c0331e73be38f6027f17e39892648e6c473ca", "0xb5d77d2f88d487ecfdf317a632d19411110325603cbde5738aca6f3599ba3228", "0x2fd36a2d7798824a0e202a3bbfe6adf9f4909a892c9da7c30a3d6d31f8caac22", "0x151db88fc523c7b7c125758e2e3afff2437cfe981fe41edc31ef87a7bc629636", "0x8eb5511405d31ef195e3edbb3b00d6ad9190a61390d19d54322811fd7bda057f", "0xa72eecf439a6f3e7dc5bfb499404c2c90a7c59a28fd923bd936acf9f1ce3497c", "0x0040365b906f30c478625da34870f79d8201fc2fa2365ce235fa972e9309a961", "0xfeba51288f3a81e7154693ea23d54d20c44cd241d84a1c0b687940dd02a01edc", "0x2483c17201879c504207f308911764d6ae8024395379f010860de90d7b91a0ea", "0xc644642ff31e3a9acb71f734a3122babca11be456bfe7e7b16571e9102607330", "0xb58acd744c693a9307a57d55ba2c9af8f2e7c4c15bd85cde0f9a4878e1717d99", "0xc6616b0ea97b9aa1ddf530bd0af21f0211c0acf5a7306057d429fe439b0fbebe", "0xd34362c4a9086ca69c8024680f4260804c13cee5847c48f4e798ebe8ed0bc345", "0x0056a005b7c99889443081e7def7eeb976061809da093a764d4e8b3bc0bf21e1", "0x2b1396fc5f8b2fb4ed3189af03b4935f59b9845624f424d20875dbd0c066df4a", "0x4dfa7d8698fd4f4840bc52c5fbccbd49913ccb7374a40cbb535464c77394396c", "0x33a8987d7c91df745a6a4184cf144594d6ec732e098d40c8fe8da6ffdadd678d", "0xd4912d38e59eb134507c0bd961a980062d68eb25d663ce2583d7e78c82089cd3", "0x37c4cf9a54cda7a44436f1641479a47aded824d79bb0c18a010bcc32c5e12976", "0xfdd0e340a690e633430629ad641deb4560a8b2c9bed2c81dfe855643fc756afa", "0xa905fd15795544b49207b110cd0b68fac5fdf858586e3a0baa4a888048a923c5", "0x495b18076554ff92b6fb3bed56040e02fabbe9c3710d111ca7c36413f90c06e2", "0xdd6e80349d36382086fdc3da72c41d0f33f85f5f0d51fc0a859640e4f8b4026b", "0x39042c739fcb9147c71831c33933adb6219c531e48a8b477f7377025db47ccec", "0x8953b6620eb91d302db3306f1e298933f9057fcb3c11c0ad053fd5d263adbaba", "0xe6d2754e1343c724fa9e179289d8ef72a1050856405c13c0867444ef3ecbfd05", "0x85d07fcdda9699bda705e635ae1b691b1dc633625724afdcaf013c60a534284b", "0x12217e4293f2dbd8ee76635162a9670791c9968b6605ccbc5e250ab96e7aa60b", "0x6762b0b54b433d9c70c01ea5ddae3ee267edbb99854ff11a054375e695a5c2d4", "0xa52f200f58024b4a0ee9b94bcc675f26ddf7048b633838d6f35fadbd4d45813c", "0x7233308651aae7765aa97a75a57e9c3d25f2e46f7d104af2e11515b8fb7bbe4e", "0x375ff505d9236362f9672c6843d00e039e40daf6d69324b955951696fa66a085", "0x99bca6c713efd478ac0832e90d5ae7edeb25b08f5372b327acae81710a8da0f8", "0x61d45294aee89467b74db5f71a135beda2d28a1006a789fe6f6dd94493998974", "0xfa5c3e921501b8a6139b3f76caa71c435e51ffcef2ff2f75878d1ab87c144a67", "0xcfaba2aa4368fe45191591ee190f3673470371e4064530d9252e025a488af54a", "0xd51d7cec321a56b1d2f3a43710b741c390c513bd1413783ca53b2ca9961bee9f", "0x9f11aded97385e4e3584263a9de864f988d70520d56b8c7738670453c2cbbcd7", "0xffb8753c2c2a7b73948a0c7a0370d1522a0c3cde21c3b71a7cde779dc57a3174", "0xc601d22afa965c67fa0ec608d042b3acf16dae70ef06b9ff14f16b899f23b810", "0x22e2689cde069d2b0ed18e65703e577d6b1d379aa03011d1e90ee6bc520f88ba", "0x8a3de5a2094bfaa8657e396fd3fe17b748487b93ae0d641b9b576bc74559dd24", "0xd91fc015e8d6a34b73d7a390e34825cc3433998593218bfaae9d7e0016770af4", "0x1d3e3cd5fff686d5a0ed155301cd223b747d7baa530b197b4eead34e0207f9a9", "0x1c16f5d8c63fcf1c812f99c70b6826c40b5444b1f65627db80bc0d5c5f60a568", "0x2a86650834f0416fa155058de9add802a7123a67bf4d10e6adf6a1b17a4d1ff7", "0xbb12f83a6791516bd16fb346f0e4004db20585b4ed811382d87f33af87154d55", "0xc3208a106ff7ffff854ec13855cd97e06daad3ee018f6caaadf590fb591a38c1", "0x497d9bcfe75f5e3a33530726e3f4b55f3bcf643c69c832a8667b2a892cfe2e56"]
else:
    print("model_length not supported")
    exit(1)

# we select only the needed number of workers (max 1k)
addresses = addresses[: n_workers]
add_new_encryption_model_args = add_new_encryption_model_args[: n_workers]

add_new_encryption_model_counter = 0
add_verification_parameters_counter = 0


for line in sys.stdin:
    proto = ""
    arguments = ""

    matched = False
    # we set parameter from this file, so we expect no arguments in method received
    m = re.search("^getModelAndBatchIndex\(\)$", line)
    if m:
        proto = "getModelAndBatchIndex()"
        matched = True
    if not matched:
        m = re.search("^addNewEncryptedModel\(\)$", line)
        if m:
            proto = "addNewEncryptedModel(uint160,bytes32)"
            worker_address = addresses[add_new_encryption_model_counter]
            model_hashed_with_address = add_new_encryption_model_args[
                add_new_encryption_model_counter]
            arg0 = encode_uint(worker_address)
            arg1 = encode_bytes32(model_hashed_with_address)
            arguments = base64.b64encode(arg0 + arg1).decode("ascii")
            # modulo to reuse the same arguments for other learn task (reduce pre-computation time which is high)
            add_new_encryption_model_counter = (
                1 + add_new_encryption_model_counter) % n_workers
            matched = True
    if not matched:
        m = re.search("^addVerificationParametersDiablo\(\)$", line)
        if m:
            proto = "addVerificationParametersDiablo(uint256[])"
            worker_address = addresses[add_verification_parameters_counter]
            # worker_weights = model_weights[add_verification_parameters_counter]
            # TODO print 5 seconds long for 100k param so see with 1.6 millions...
            # only send the first 1k weights, smart contract will expect into the expected model weight
            worker_weights = good_model[:1000] if add_verification_parameters_counter % 5 != 0 else bad_model[:1000]
            encoded_array = encode_abi(
                ["int256[]"], [[worker_address] + worker_weights]
            )
            arguments = base64.b64encode(encoded_array).decode("ascii")
            # modulo to reuse the same arguments for other learn task (reduce pre-computation time which is high)
            add_verification_parameters_counter = (
                1 + add_verification_parameters_counter) % n_workers
            matched = True
    if not matched:
        # received line isn't a valid method (check yaml file and smart contract method name)
        exit(1)

    # we can print the fonction and the arguments
    print(proto)
    print(arguments, flush=True)
